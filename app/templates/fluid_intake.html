<!-- C:\Users\Peter\Blueprint\app\templates\fluid_intake_form.html -->
{% extends "base.html" %}

{% block content %}
    <h2 class = "center-text"> Fluid Intake Form </h2>
    <form method="POST" action="{{ url_for('data_input.submit_fluid_intake') }}" 
    class="form-container" onsubmit="return check_staff_initials()">
    <input type="hidden" name="unit_name" value="{{ request.args.get('unit_name') }}">
    <input type="hidden" name="resident_initials" value="{{ request.args.get('resident_initials') }}">
    
        <div class = 'form-group'>
        <label for="fluid">Select fluid:</label>
            <select id="fluid" name="fluid_name" required>
                <option value="">--Select Fluid--</option>
                {% for fluid in fluid_list %}
                    <option value="{{ fluid}}">{{ fluid }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="fluid_volume">Fluid Volume (ml):</label>
            <input type="number" id="fluid_volume" name="fluid_volume" class="no-spinner" required placeholder="Enter '0' if refused">
        </div>
        <div class = 'form-group'>
        <label for="fluid_note">Note:</label>
        <textarea id="fluid_note" name="fluid_note" placeholder="Refused/Asleep"></textarea>
        </div>
        <div class="form-group">
            <label for="input_time">Time of Record:</label>
            <input type="time" id="input_time" name="input_time" required>
        </div>
        <div class="form-group">
            <label for="staff_initials">Staff Initials:</label>
            <input type="text" id="staff_initials" name="staff_initials" required>
        </div>
        <button type="submit">Submit</button>
    </form>

    <script>
        // Set the default value of the time input field to the current time
        document.addEventListener('DOMContentLoaded', (event) => {
            const now = new Date();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            document.getElementById('input_time').value = `${hours}:${minutes}`;
        });
    </script>

    <script>
        // Check staff initials input field for valid input
        function check_staff_initials() {
            const staffInitials = document.getElementById('staff_initials').value.toUpperCase();
            // Add regex validation for staff initials format (2 letters followed by 2 numbers)
            const regex = /^[A-Z]{2}\d{2}$/;
            
            if (!regex.test(staffInitials)) {
            alert('Staff initials must be 2 letters followed by 2 numbers');
            return false;
            }
            return true;
            }


    </script>


{% endblock %}